@import com.gu.i18n.CountryGroup.US
@import com.gu.memsub.Current
@import com.gu.salesforce.Tier.Supporter
@import com.gu.membership.PaidMembershipPlans
@import views.support.PageInfo
@(supporterPlans: PaidMembershipPlans[Current, Supporter],
  pageInfo: PageInfo,
  pageImages: Seq[model.ResponsiveImageGroup])(implicit token: play.filters.csrf.CSRF.Token)

@import com.gu.salesforce.Tier.Supporter
@import configuration.Videos
@import views.support.Asset

@section(title: String = "", hasBorder: Boolean = true)(content: Html) = {
    <section class="page-slice page-slice--listing">
        <div class="l-constrained">
            <div class="listing listing--narrow @if(hasBorder){listing--bordered}">
                <div class="listing__lead-in">
                    <h3 class="h-intro">@title</h3>
                </div>
                <div class="listing__content">@content</div>
            </div>
        </div>
    </section>
}

@sectionCardStack(img: model.ResponsiveImageGroup)(content: Html) = {
    <section class="page-slice page-slice--listing">
        <div class="l-constrained">
            <div class="listing listing--narrow listing--card-stack">
                @* lead-in is empty but provides column alignment at larger widths *@
                <div class="listing__lead-in"></div>
                <div class="listing__content">
                    <div class="listing--card-stack__card-one"></div>
                    <div class="listing--card-stack__card-two"></div>
                    <div class="listing--card-stack__card-three"></div>
                    @content
                </div>
            </div>
            <figure class="captioned-image">
                <img src="@img.defaultImage" srcset="@img.srcset" sizes="100vw" alt="@img.metadataAltText.getOrElse("")" class="responsive-img" />
                @for(metadata <- img.metadata) {
                    <figcaption class="captioned-image__detail captioned-image__detail--right">
                        <div class="captioned-image__caption">
                        @fragments.media.imageCaption(metadata)
                        </div>
                    </figcaption>
                }
            </figure>
        </div>
    </section>
}

@main("Supporters", pageInfo=pageInfo) {
    @fragments.page.heroBanner(
        "Become a Guardian&nbsp;Supporter",
        "Supporters keep our journalism fearless and free to tell the stories other news organizations won’t",
        "hero-banner--us-supporter"
    )()

    @section(hasBorder = false) {
        @fragments.tier.packagePromoUSASupporter(supporterPlans)
    }

    @*
     * This section doesn't use the template above because the following
     * section has no lead-in so we need this section to have no bottom padding.
     * Rather than add some arbitrary parameters to the template, we use some custom HTML.
     *@
    <section>
        <div class="l-constrained">
            <div class="listing listing--no-bottom-padding listing--bordered">
                <div class="listing__lead-in">
                    <h3 class="h-intro">Support open, independent journalism</h3>
                </div>
                <div class="listing__content">
                    <div class="video-preview video-preview--plain">
                        <div class="video-preview__video">
                        @fragments.media.videoPlayer(Videos.supporters)
                        </div>
                        <div class="video-preview__header">
                            @fragments.inlineIcon("video", List("icon-inline--scale"))
                            Watch Guardian journalists explain why the Guardian’s unique approach to journalism is worth defending
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    @for(img <- pageImages.find(_.name.contains("fearless"))) {
        @sectionCardStack(img) {
            <div class="listing__text">
                <p>The Guardian shines a light on critical, underreported stories across the US and the globe.</p>
                <p>Without a paywall, our journalism is open to everyone.</p>
                <p>
                    <a class="action" href="@{routes.Joiner.enterPaidDetails(supporterPlans.tier)}?countryGroup=@US.id">Become a Supporter</a>
                </p>
            </div>
        }
    }

    @section("If you read the Guardian, join the Guardian") {
        @fragments.promos.promoQuote(
            Asset.at("images/common/katharine-viner-cutout.png"),
            "Katharine Viner, editor-in-chief of the Guardian"
        ) {
            <blockquote class="blockquote blockquote--feature">
                With Guardian Members we have a profound opportunity to
                defend the Guardian's independent journalism and collaborate
                together on a better, more informed future.
                <cite class="blockquote__citation">Katharine Viner, editor-in-chief of the Guardian</cite>
            </blockquote>
        }
    }

    @section("What's included") {
        @fragments.tier.packagePromoUSASupporter(supporterPlans)
    }
}
